<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Error 521</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f7f7f7;
        margin: 0;
        padding: 0;
        color: #333;
        text-align: center;
    }
    h1 {
        font-size: 42px;
        margin-top: 40px;
        font-weight: 600;
    }
    .subtitle {
        font-size: 22px;
        margin-bottom: 20px;
        color: #666;
    }
    .container {
        display: flex;
        justify-content: center;
        margin-top: 40px;
        gap: 150px;
        flex-wrap: wrap;
    }
    .box {
        width: 200px;
    }
    .icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 15px auto;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        color: white;
    }
    .green { background: #4caf50; }
    .red { background: #e53935; }
    .label1 { font-size: 20px; font-weight: bold; margin-bottom: 6px; }
    .label2 { font-size: 17px; color: #777; line-height: 1.4; }
    .status-text { font-weight: bold; }
    .green-text { color: #4caf50; }
    .red-text { color: #e53935; }
    .ip-display {
        margin-top: 60px;
        font-size: 16px;
        color: #555;
        cursor: pointer;
        user-select: none;
    }
</style>
</head>
<body>

<h1>Error 521</h1>
<div class="subtitle">Web server is down</div>

<div class="container" id="status-container">

</div>

<div class="ip-display" id="ip-display">
    Your IP: Click to reveal • UTC: <span id="utc-time"></span>
</div>

<script>
    const container = document.getElementById("status-container");
    const ipDisplay = document.getElementById("ip-display");
    const utcTimeSpan = document.getElementById("utc-time");

    function getUTCTime() {
        return new Date().toUTCString().replace("GMT", "UTC");
    }

    function updateTime() {
        utcTimeSpan.textContent = getUTCTime();
    }
    updateTime();
    setInterval(updateTime, 1000);

    fetch("https://api.ipify.org?format=json")
        .then(res => res.json())
        .then(ipData => {
            const userIP = ipData.ip || "Unknown IP";

            fetch(`https://ipwhois.app/json/${userIP}`)
                .then(res => res.json())
                .then(geoData => {
                    const city = geoData.city || "London";

                    const statuses = [
                        { label: "You", status: "Working", detail: "Browser" },
                        { label: city, status: "Working", detail: "Goopers Servers" },
                        { label: "https://gooper.net", status: "Error", detail: "Host" }
                    ];

                    statuses.forEach(s => {
                        const box = document.createElement("div");
                        box.className = "box";

                        const icon = document.createElement("div");
                        icon.className = "icon " + (s.status === "Working" ? "green" : "red");
                        icon.textContent = s.status === "Working" ? "✔" : "✖";

                        const label1 = document.createElement("div");
                        label1.className = "label1";
                        label1.textContent = s.label;

                        const label2 = document.createElement("div");
                        label2.className = "label2";
                        label2.innerHTML = `${s.detail}<br><span class="status-text ${s.status === "Working" ? "green-text" : "red-text"}">${s.status}</span>`;

                        box.appendChild(icon);
                        box.appendChild(label1);
                        box.appendChild(label2);

                        container.appendChild(box);
                    });

                    ipDisplay.addEventListener("click", () => {
                        ipDisplay.innerHTML = `Your IP: ${userIP} • UTC: <span id="utc-time">${getUTCTime()}</span>`;
                        setInterval(() => {
                            document.getElementById("utc-time").textContent = getUTCTime();
                        }, 1000);
                    });
                })
                .catch(() => fallbackRender(userIP));
        })
        .catch(() => ipDisplay.textContent = "Unable to fetch IP • UTC: " + getUTCTime());

    function fallbackRender(userIP) {
        const statuses = [
            { label: "You", status: "Working", detail: "Browser" },
            { label: "London", status: "Working", detail: "Goopers Servers" },
            { label: "https://gooper.net", status: "Error", detail: "Host" }
        ];

        statuses.forEach(s => {
            const box = document.createElement("div");
            box.className = "box";

            const icon = document.createElement("div");
            icon.className = "icon " + (s.status === "Working" ? "green" : "red");
            icon.textContent = s.status === "Working" ? "✔" : "✖";

            const label1 = document.createElement("div");
            label1.className = "label1";
            label1.textContent = s.label;

            const label2 = document.createElement("div");
            label2.className = "label2";
            label2.innerHTML = `${s.detail}<br><span class="status-text ${s.status === "Working" ? "green-text" : "red-text"}">${s.status}</span>`;

            box.appendChild(icon);
            box.appendChild(label1);
            box.appendChild(label2);

            container.appendChild(box);
        });

        ipDisplay.addEventListener("click", () => {
            ipDisplay.innerHTML = `Your IP: ${userIP} • UTC: <span id="utc-time">${getUTCTime()}</span>`;
            setInterval(() => {
                document.getElementById("utc-time").textContent = getUTCTime();
            }, 1000);
        });
    }
</script>

</body>
</html>
